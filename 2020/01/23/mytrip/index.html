<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>实战携程App | HanJQ's Tech Blog</title><meta name="description" content="实战携程App"><meta name="keywords" content="Flutter,移动开发"><meta name="author" content="HanJQ"><meta name="copyright" content="HanJQ"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta name="twitter:card" content="summary"><meta name="twitter:title" content="实战携程App"><meta name="twitter:description" content="实战携程App"><meta name="twitter:image" content="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579787484877&amp;di=b435abf9485bb65adf52e3394c029401&amp;imgtype=0&amp;src=http%3A%2F%2Fhzadm.zhongchoujia.com%2FUploadFiles%2F2016-12-08%2F6361680627104931767309148.png"><meta property="og:type" content="article"><meta property="og:title" content="实战携程App"><meta property="og:url" content="http://coderhan.cn/2020/01/23/mytrip/"><meta property="og:site_name" content="HanJQ's Tech Blog"><meta property="og:description" content="实战携程App"><meta property="og:image" content="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579787484877&amp;di=b435abf9485bb65adf52e3394c029401&amp;imgtype=0&amp;src=http%3A%2F%2Fhzadm.zhongchoujia.com%2FUploadFiles%2F2016-12-08%2F6361680627104931767309148.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://coderhan.cn/2020/01/23/mytrip/"><link rel="next" title="高仿ONE•一个" href="http://coderhan.cn/2020/01/23/LearnFlutter/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">HanJQ's Tech Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">2</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">2</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">1</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Dart语言基础"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Dart语言基础</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#static、final、const"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">static、final、const</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#null相关"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">null相关</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#异步编程"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">异步编程</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Flutter基础"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Flutter基础</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#LIstView"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">LIstView</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#状态管理"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">状态管理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#获取外部App传入的数据"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">获取外部App传入的数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#跳转其他App"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">跳转其他App</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#线程和异步UI"><span class="toc_mobile_items-number">2.5.</span> <span class="toc_mobile_items-text">线程和异步UI</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#图片"><span class="toc_mobile_items-number">2.6.</span> <span class="toc_mobile_items-text">图片</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Image支持如下几种类型的构造函数："><span class="toc_mobile_items-number">2.6.1.</span> <span class="toc_mobile_items-text">Image支持如下几种类型的构造函数：</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Image支持的图片格式"><span class="toc_mobile_items-number">2.6.2.</span> <span class="toc_mobile_items-text">Image支持的图片格式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何加载网络图片？"><span class="toc_mobile_items-number">2.6.3.</span> <span class="toc_mobile_items-text">如何加载网络图片？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何加载静态图片，以及处理不同分辨率的图片？"><span class="toc_mobile_items-number">2.6.4.</span> <span class="toc_mobile_items-text">如何加载静态图片，以及处理不同分辨率的图片？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何加载本地图片？"><span class="toc_mobile_items-number">2.6.5.</span> <span class="toc_mobile_items-text">如何加载本地图片？</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#加载完整路径的本地图片"><span class="toc_mobile_items-number">2.6.5.1.</span> <span class="toc_mobile_items-text">加载完整路径的本地图片</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#加载相对路径的本地图片"><span class="toc_mobile_items-number">2.6.5.2.</span> <span class="toc_mobile_items-text">加载相对路径的本地图片</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何设置Placeholder"><span class="toc_mobile_items-number">2.6.6.</span> <span class="toc_mobile_items-text">如何设置Placeholder?</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#从内存中加载Placeholder"><span class="toc_mobile_items-number">2.6.6.1.</span> <span class="toc_mobile_items-text">从内存中加载Placeholder</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#从本地资源中加载Placeholder"><span class="toc_mobile_items-number">2.6.6.2.</span> <span class="toc_mobile_items-text">从本地资源中加载Placeholder</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何配置图片缓存？"><span class="toc_mobile_items-number">2.6.7.</span> <span class="toc_mobile_items-text">如何配置图片缓存？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何加载Icon？"><span class="toc_mobile_items-number">2.6.8.</span> <span class="toc_mobile_items-text">如何加载Icon？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用Icons"><span class="toc_mobile_items-number">2.6.9.</span> <span class="toc_mobile_items-text">使用Icons</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用自定义的Icon"><span class="toc_mobile_items-number">2.6.10.</span> <span class="toc_mobile_items-text">使用自定义的Icon</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#点击事件"><span class="toc_mobile_items-number">2.7.</span> <span class="toc_mobile_items-text">点击事件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#自定义字体使用以及MaterialApp主题themeData设置"><span class="toc_mobile_items-number">2.8.</span> <span class="toc_mobile_items-text">自定义字体使用以及MaterialApp主题themeData设置</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#动画"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">动画</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#目录"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">目录</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#在Flutter中有哪些类型的动画？"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">在Flutter中有哪些类型的动画？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#如何使用动画库中的基础类给widget添加动画？"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">如何使用动画库中的基础类给widget添加动画？</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Animation"><span class="toc_mobile_items-number">3.3.1.</span> <span class="toc_mobile_items-text">Animation</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CurvedAnimation"><span class="toc_mobile_items-number">3.3.2.</span> <span class="toc_mobile_items-text">CurvedAnimation</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#AnimationController"><span class="toc_mobile_items-number">3.3.3.</span> <span class="toc_mobile_items-text">AnimationController</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Tween"><span class="toc_mobile_items-number">3.3.4.</span> <span class="toc_mobile_items-text">Tween</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#Tween-animate"><span class="toc_mobile_items-number">3.3.4.1.</span> <span class="toc_mobile_items-text">Tween.animate</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#为widget添加动画"><span class="toc_mobile_items-number">3.3.5.</span> <span class="toc_mobile_items-text">为widget添加动画</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#如何为动画添加监听器？"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">如何为动画添加监听器？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是AnimatedWidget？"><span class="toc_mobile_items-number">3.5.1.</span> <span class="toc_mobile_items-text">什么是AnimatedWidget？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是AnimatedBuilder？"><span class="toc_mobile_items-number">3.5.2.</span> <span class="toc_mobile_items-text">什么是AnimatedBuilder？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#示例项目学习"><span class="toc_mobile_items-number">3.5.3.</span> <span class="toc_mobile_items-text">示例项目学习</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-导航栏"><span class="toc_mobile_items-number">3.6.</span> <span class="toc_mobile_items-text">1.导航栏</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#PageView-页面组"><span class="toc_mobile_items-number">3.7.</span> <span class="toc_mobile_items-text">PageView 页面组</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#BottomNavigationBar-底部导航栏"><span class="toc_mobile_items-number">3.7.1.</span> <span class="toc_mobile_items-text">BottomNavigationBar 底部导航栏</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#完整代码"><span class="toc_mobile_items-number">3.7.2.</span> <span class="toc_mobile_items-text">完整代码</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-搜索栏"><span class="toc_mobile_items-number">3.8.</span> <span class="toc_mobile_items-text">2.搜索栏</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#轮播Banner"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">轮播Banner</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#entity和dao层"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">entity和dao层</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#下拉刷新-RefreshIndicator"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">下拉刷新  RefreshIndicator</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#包与插件"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">包与插件</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Dart语言基础"><span class="toc-number">1.</span> <span class="toc-text">Dart语言基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#static、final、const"><span class="toc-number">1.1.</span> <span class="toc-text">static、final、const</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null相关"><span class="toc-number">1.2.</span> <span class="toc-text">null相关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#异步编程"><span class="toc-number">1.3.</span> <span class="toc-text">异步编程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Flutter基础"><span class="toc-number">2.</span> <span class="toc-text">Flutter基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LIstView"><span class="toc-number">2.1.</span> <span class="toc-text">LIstView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#状态管理"><span class="toc-number">2.2.</span> <span class="toc-text">状态管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取外部App传入的数据"><span class="toc-number">2.3.</span> <span class="toc-text">获取外部App传入的数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#跳转其他App"><span class="toc-number">2.4.</span> <span class="toc-text">跳转其他App</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程和异步UI"><span class="toc-number">2.5.</span> <span class="toc-text">线程和异步UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图片"><span class="toc-number">2.6.</span> <span class="toc-text">图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Image支持如下几种类型的构造函数："><span class="toc-number">2.6.1.</span> <span class="toc-text">Image支持如下几种类型的构造函数：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Image支持的图片格式"><span class="toc-number">2.6.2.</span> <span class="toc-text">Image支持的图片格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何加载网络图片？"><span class="toc-number">2.6.3.</span> <span class="toc-text">如何加载网络图片？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何加载静态图片，以及处理不同分辨率的图片？"><span class="toc-number">2.6.4.</span> <span class="toc-text">如何加载静态图片，以及处理不同分辨率的图片？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何加载本地图片？"><span class="toc-number">2.6.5.</span> <span class="toc-text">如何加载本地图片？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#加载完整路径的本地图片"><span class="toc-number">2.6.5.1.</span> <span class="toc-text">加载完整路径的本地图片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加载相对路径的本地图片"><span class="toc-number">2.6.5.2.</span> <span class="toc-text">加载相对路径的本地图片</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何设置Placeholder"><span class="toc-number">2.6.6.</span> <span class="toc-text">如何设置Placeholder?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#从内存中加载Placeholder"><span class="toc-number">2.6.6.1.</span> <span class="toc-text">从内存中加载Placeholder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#从本地资源中加载Placeholder"><span class="toc-number">2.6.6.2.</span> <span class="toc-text">从本地资源中加载Placeholder</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何配置图片缓存？"><span class="toc-number">2.6.7.</span> <span class="toc-text">如何配置图片缓存？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何加载Icon？"><span class="toc-number">2.6.8.</span> <span class="toc-text">如何加载Icon？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Icons"><span class="toc-number">2.6.9.</span> <span class="toc-text">使用Icons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用自定义的Icon"><span class="toc-number">2.6.10.</span> <span class="toc-text">使用自定义的Icon</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#点击事件"><span class="toc-number">2.7.</span> <span class="toc-text">点击事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义字体使用以及MaterialApp主题themeData设置"><span class="toc-number">2.8.</span> <span class="toc-text">自定义字体使用以及MaterialApp主题themeData设置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#动画"><span class="toc-number">3.</span> <span class="toc-text">动画</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#目录"><span class="toc-number">3.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在Flutter中有哪些类型的动画？"><span class="toc-number">3.2.</span> <span class="toc-text">在Flutter中有哪些类型的动画？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何使用动画库中的基础类给widget添加动画？"><span class="toc-number">3.3.</span> <span class="toc-text">如何使用动画库中的基础类给widget添加动画？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Animation"><span class="toc-number">3.3.1.</span> <span class="toc-text">Animation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CurvedAnimation"><span class="toc-number">3.3.2.</span> <span class="toc-text">CurvedAnimation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AnimationController"><span class="toc-number">3.3.3.</span> <span class="toc-text">AnimationController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tween"><span class="toc-number">3.3.4.</span> <span class="toc-text">Tween</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tween-animate"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">Tween.animate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为widget添加动画"><span class="toc-number">3.3.5.</span> <span class="toc-text">为widget添加动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何为动画添加监听器？"><span class="toc-number">3.4.</span> <span class="toc-text">如何为动画添加监听器？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用"><span class="toc-number">3.5.</span> <span class="toc-text">用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是AnimatedWidget？"><span class="toc-number">3.5.1.</span> <span class="toc-text">什么是AnimatedWidget？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是AnimatedBuilder？"><span class="toc-number">3.5.2.</span> <span class="toc-text">什么是AnimatedBuilder？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例项目学习"><span class="toc-number">3.5.3.</span> <span class="toc-text">示例项目学习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-导航栏"><span class="toc-number">3.6.</span> <span class="toc-text">1.导航栏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PageView-页面组"><span class="toc-number">3.7.</span> <span class="toc-text">PageView 页面组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BottomNavigationBar-底部导航栏"><span class="toc-number">3.7.1.</span> <span class="toc-text">BottomNavigationBar 底部导航栏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#完整代码"><span class="toc-number">3.7.2.</span> <span class="toc-text">完整代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-搜索栏"><span class="toc-number">3.8.</span> <span class="toc-text">2.搜索栏</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#轮播Banner"><span class="toc-number">4.</span> <span class="toc-text">轮播Banner</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#entity和dao层"><span class="toc-number">5.</span> <span class="toc-text">entity和dao层</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#下拉刷新-RefreshIndicator"><span class="toc-number">6.</span> <span class="toc-text">下拉刷新  RefreshIndicator</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#包与插件"><span class="toc-number">7.</span> <span class="toc-text">包与插件</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579787484877&amp;di=b435abf9485bb65adf52e3394c029401&amp;imgtype=0&amp;src=http%3A%2F%2Fhzadm.zhongchoujia.com%2FUploadFiles%2F2016-12-08%2F6361680627104931767309148.png)"><div id="post-info"><div id="post-title"><div class="posttitle">实战携程App</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2020-01-23<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2020-01-23</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Flutter/">Flutter</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="Dart语言基础"><a href="#Dart语言基础" class="headerlink" title="Dart语言基础"></a>Dart语言基础</h1><h2 id="static、final、const"><a href="#static、final、const" class="headerlink" title="static、final、const"></a>static、final、const</h2><p>final的值只能设置一次，而const在声明时就确定，const是更严格的final。</p>
<p>static主要修饰类变量，可与final、const合用。</p>
<h2 id="null相关"><a href="#null相关" class="headerlink" title="null相关"></a>null相关</h2><p>if( 必须是bool类型或表达式 )  只有true才是true</p>
<p><code>obj ?. exp1 ?. exp2 ...</code>  只要?.左边出现null则停止执行并返回null，不是null才往右执行链式调用。</p>
<p><code>obj/exp ?? 默认值</code>  如果??左边为null就返回默认值。</p>
<p>例子 <code>response?.data?.length ?? 0</code>    返回对象内列表长度。</p>
<h2 id="异步编程"><a href="#异步编程" class="headerlink" title="异步编程"></a>异步编程</h2><p>async和await</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dart</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">test()<span class="keyword">async</span>&#123;</span><br><span class="line">	...  <span class="comment">//立刻执行</span></span><br><span class="line">    ...  <span class="comment">//立刻执行</span></span><br><span class="line">  <span class="keyword">var</span> response = <span class="keyword">await</span> dio.<span class="keyword">get</span>(url);  <span class="comment">//阻塞，等待请求完毕</span></span><br><span class="line">  <span class="built_in">print</span>(response.data); <span class="comment">//请求完毕后执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>


<h1 id="Flutter基础"><a href="#Flutter基础" class="headerlink" title="Flutter基础"></a>Flutter基础</h1><h2 id="LIstView"><a href="#LIstView" class="headerlink" title="LIstView"></a>LIstView</h2><p>当数据量较大或动态更新item时推荐使用ListView.Builder构建ListView。</p>
<p>widget.add( xxx );  //增加新控件  </p>
<h2 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h2><ul>
<li><p>如果所讨论的状态是用户数据，例如复选框的已选中或未选中状态，或滑块的位置，则状态最好由父widget管理；</p>
</li>
<li><p>如果widget的状态取决于动作，例如动画，那么最好是由widget自身来管理状态；</p>
</li>
<li><p>如有还是不确定谁管理状态，请让父widget管理子widget的状态；</p>
</li>
</ul>
<h2 id="获取外部App传入的数据"><a href="#获取外部App传入的数据" class="headerlink" title="获取外部App传入的数据"></a>获取外部App传入的数据</h2><p>Native通信、MethodChannel</p>
<h2 id="跳转其他App"><a href="#跳转其他App" class="headerlink" title="跳转其他App"></a>跳转其他App</h2><p>url_launcher插件</p>
<h2 id="线程和异步UI"><a href="#线程和异步UI" class="headerlink" title="线程和异步UI"></a>线程和异步UI</h2><ul>
<li><p>async和await：处理网络请求、数据库访问等IO操作</p>
</li>
<li><p>Isolate：发挥多核心 CPU 的优势来处理那些长期运行或是计算密集型的任务。</p>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener"><code>Isolate</code></a> 是分离的运行线程，并且不和主线程的内存堆共享内存。这意味着你不能访问主线程中的变量，或者使用 <a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener"><code>setState()</code></a> 来更新 UI。正如它们的名字一样，Isolate 不能共享内存。</p>
</li>
</ul>
<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><h3 id="Image支持如下几种类型的构造函数："><a href="#Image支持如下几种类型的构造函数：" class="headerlink" title="Image支持如下几种类型的构造函数："></a>Image支持如下几种类型的构造函数：</h3><ul>
<li><a href="https://docs.flutter.io/flutter/widgets/Image/Image.html" target="_blank" rel="noopener">new Image</a> - 用于从ImageProvider获取图像；</li>
<li><a href="https://docs.flutter.io/flutter/widgets/Image/Image.asset.html" target="_blank" rel="noopener">new Image.asset</a> - 使用key 从AssetBundle获得的图像；</li>
<li><a href="https://docs.flutter.io/flutter/widgets/Image/Image.network.html" target="_blank" rel="noopener">new Image.network</a> - 从网络URL中获取图片；</li>
<li><a href="https://docs.flutter.io/flutter/widgets/Image/Image.file.html" target="_blank" rel="noopener">new Image.file</a> - 从本地文件中获取图片；</li>
<li><a href="https://docs.flutter.io/flutter/widgets/Image/Image.memory.html" target="_blank" rel="noopener">new Image.memory</a> - 用于从Uint8List获取图像；</li>
</ul>
<blockquote>
<p>在加载项目中的图片资源时，为了让Image能够根据像素密度自动适配不同分辨率的图片，请使用<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>AssetImage</code></a>指定图像，并确保在widget树中的“Image” widget上方存在<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>MaterialApp</code></a>，<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>WidgetsApp</code></a>或<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>MediaQuery</code></a>窗口widget。</p>
</blockquote>
<h3 id="Image支持的图片格式"><a href="#Image支持的图片格式" class="headerlink" title="Image支持的图片格式"></a>Image支持的图片格式</h3><p>Image 支持以下类型的图片：JPEG, PNG, GIF, Animated GIF, WebP, Animated WebP, BMP, 和 WBMP。</p>
<h3 id="如何加载网络图片？"><a href="#如何加载网络图片？" class="headerlink" title="如何加载网络图片？"></a>如何加载网络图片？</h3><p>要加载网络图片，我们需要使用<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>Image.network</code></a>构造方法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Image.network(</span><br><span class="line">  &#39;https:&#x2F;&#x2F;www.devio.org&#x2F;img&#x2F;avatar.png&#39;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>demo:</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">class MyApp extends StatelessWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return new MaterialApp(</span><br><span class="line">      title: &#39;Flutter bottomNavigationBar&#39;,</span><br><span class="line">      theme: new ThemeData.fallback(),</span><br><span class="line">      home: Image.network(</span><br><span class="line">        &#39;https:&#x2F;&#x2F;www.devio.org&#x2F;img&#x2F;avatar.png&#39;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="如何加载静态图片，以及处理不同分辨率的图片？"><a href="#如何加载静态图片，以及处理不同分辨率的图片？" class="headerlink" title="如何加载静态图片，以及处理不同分辨率的图片？"></a>如何加载静态图片，以及处理不同分辨率的图片？</h3><p>要加载项目中的静态图片，需要一些两步：</p>
<ul>
<li>在 <a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">pubspec.yaml</a> 文件中声明图片资源的路径；</li>
<li>使用<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>AssetImage</code></a>访问图片；</li>
</ul>
<blockquote>
<p>我们在<a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">《快速上手Flutter开发》</a>的<a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">《项目结构、资源、依赖和本地化》</a>一节中详细讲解过如何归档图片资源以及处理不同分辨率的图片，在这里就不重复了。</p>
</blockquote>
<p><a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">pubspec.yaml</a>声明图片路径：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assets:</span><br><span class="line"> - images&#x2F;my_icon.png</span><br></pre></td></tr></table></figure></div>

<p>使用<code>AssetImage</code>访问图片图片：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Image(</span><br><span class="line">  height: 26,</span><br><span class="line">  width: 26,</span><br><span class="line">  image: AssetImage(my_icon.png),</span><br><span class="line">),</span><br></pre></td></tr></table></figure></div>

<p>除了我们使用Image的构造方法手动指定<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">AssetImage</a>之外，还可通过<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener"><code>Image.asset</code></a>来加载静态图片：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Image.asset(my_icon.png,</span><br><span class="line">	width: 26,</span><br><span class="line">	height: 26,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<p>两者是等效的。</p>
<p>/sdcard/Download/Stack.png</p>
<h3 id="如何加载本地图片？"><a href="#如何加载本地图片？" class="headerlink" title="如何加载本地图片？"></a>如何加载本地图片？</h3><h4 id="加载完整路径的本地图片"><a href="#加载完整路径的本地图片" class="headerlink" title="加载完整路径的本地图片"></a>加载完整路径的本地图片</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#39;dart:io&#39;;</span><br><span class="line">Image.file(File(&#39;&#x2F;sdcard&#x2F;Download&#x2F;Stack.png&#39;)),</span><br></pre></td></tr></table></figure></div>

<h4 id="加载相对路径的本地图片"><a href="#加载相对路径的本地图片" class="headerlink" title="加载相对路径的本地图片"></a>加载相对路径的本地图片</h4><blockquote>
<p>第一步：</p>
</blockquote>
<p>在<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">pubspec.yaml</a>中添加<a href="https://pub.dartlang.org/packages/path_provider" target="_blank" rel="noopener">path_provider</a>插件；</p>
<blockquote>
<p>第二步：导入头文件</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#39;dart:io&#39;;</span><br><span class="line">import &#39;package:path_provider&#x2F;path_provider.dart&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Image.file(File(&#39;&#x2F;sdcard&#x2F;Download&#x2F;Stack.png&#39;)),</span><br><span class="line">FutureBuilder(future: _getLocalFile(&quot;Download&#x2F;Stack.png&quot;),</span><br><span class="line">  builder:  (BuildContext context, AsyncSnapshot&lt;File&gt; snapshot) &#123;</span><br><span class="line">    return snapshot.data !&#x3D; null ? Image.file(snapshot.data) : Container();</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br><span class="line">&#x2F;&#x2F;获取SDCard的路径：</span><br><span class="line"> Future&lt;File&gt; _getLocalFile(String filename) async &#123;</span><br><span class="line">    String dir &#x3D; (await getExternalStorageDirectory()).path;</span><br><span class="line">    File f &#x3D; new File(&#39;$dir&#x2F;$filename&#39;);</span><br><span class="line">    return f;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="如何设置Placeholder"><a href="#如何设置Placeholder" class="headerlink" title="如何设置Placeholder?"></a>如何设置<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">Placeholder</a>?</h3><p>为了设置<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">Placeholder</a>我们需要借助<a href="https://docs.flutter.io/flutter/widgets/FadeInImage-class.html" target="_blank" rel="noopener">FadeInImage</a>，它能够从内存，本地资源中加载placeholder。</p>
<h4 id="从内存中加载Placeholder"><a href="#从内存中加载Placeholder" class="headerlink" title="从内存中加载Placeholder"></a>从内存中加载<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">Placeholder</a></h4><blockquote>
<p>第一步：</p>
</blockquote>
<p>安装<a href="https://pub.dartlang.org/packages/transparent_image" target="_blank" rel="noopener">transparent_image</a>插件。</p>
<blockquote>
<p>第二步：</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">class MyApp extends StatelessWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    final title &#x3D; &#39;Fade in images&#39;;</span><br><span class="line"></span><br><span class="line">    return MaterialApp(</span><br><span class="line">      title: title,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: Text(title),</span><br><span class="line">        ),</span><br><span class="line">        body: Stack(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Center(child: CircularProgressIndicator()),</span><br><span class="line">            Center(</span><br><span class="line">              child: FadeInImage.memoryNetwork(</span><br><span class="line">                placeholder: kTransparentImage,</span><br><span class="line">                image: &#39;https:&#x2F;&#x2F;www.devio.org&#x2F;img&#x2F;avatar.png&#39;,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h4 id="从本地资源中加载Placeholder"><a href="#从本地资源中加载Placeholder" class="headerlink" title="从本地资源中加载Placeholder"></a>从本地资源中加载<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">Placeholder</a></h4><blockquote>
<p>第一步</p>
</blockquote>
<p>配置本地资源图片：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> flutter:</span><br><span class="line">   assets:</span><br><span class="line">+    - assets&#x2F;loading.gif</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>第二步</p>
</blockquote>
<p>加载本地资源图片作为<a href="https://coding.imooc.com/learn/qa/321.html" target="_blank" rel="noopener">Placeholder</a>：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FadeInImage.assetNetwork(</span><br><span class="line">  placeholder: &#39;assets&#x2F;loading.gif&#39;,</span><br><span class="line">  image: &#39;https:&#x2F;&#x2F;www.devio.org&#x2F;img&#x2F;avatar.png&#39;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="如何配置图片缓存？"><a href="#如何配置图片缓存？" class="headerlink" title="如何配置图片缓存？"></a>如何配置图片缓存？</h3><p>在Flutter中我们可以借助<a href="https://pub.dartlang.org/packages/cached_network_image" target="_blank" rel="noopener">cached_network_image</a>插件，来从网络上加载图片，并且将其缓存到本地，以供下次使用。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class MyApp extends StatelessWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    final title &#x3D; &#39;Cached Images&#39;;</span><br><span class="line"></span><br><span class="line">    return MaterialApp(</span><br><span class="line">      title: title,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: Text(title),</span><br><span class="line">        ),</span><br><span class="line">        body: Center(</span><br><span class="line">          child: CachedNetworkImage(</span><br><span class="line">            placeholder: (context, url) &#x3D;&gt; new CircularProgressIndicator(),</span><br><span class="line">            imageUrl:</span><br><span class="line">                &#39;https:&#x2F;&#x2F;picsum.photos&#x2F;250?image&#x3D;9&#39;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>关于创建<code>图片控件开发详解</code>的更多实战技巧与最佳实践可学习<a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">《基于Flutter1.x开发携程网App》</a>。</p>
</blockquote>
<h3 id="如何加载Icon？"><a href="#如何加载Icon？" class="headerlink" title="如何加载Icon？"></a>如何加载Icon？</h3><p>在Flutter中我们可以借助<a href="https://docs.flutter.io/flutter/widgets/Icon-class.html" target="_blank" rel="noopener">Icon</a>来加载icon：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const Icon(this.icon&#x2F;&#x2F;IconDate, &#123;</span><br><span class="line">   Key key,</span><br><span class="line">   this.size,&#x2F;&#x2F;大小</span><br><span class="line">   this.color,&#x2F;&#x2F;颜色</span><br><span class="line">   this.semanticLabel,&#x2F;&#x2F;标志位</span><br><span class="line">   this.textDirection,&#x2F;&#x2F;绘制方向，一般使用不到</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<p>从Icon的构造方法可以很清楚的看出Icon构造方法需要一个默认的类型为IconData类型的参数，我们可以构造一个自己的IconData，也可以使用Flutter提供的<a href="https://design.google.com/icons/" target="_blank" rel="noopener">material_fonts</a>。</p>
<h3 id="使用Icons"><a href="#使用Icons" class="headerlink" title="使用Icons"></a>使用Icons</h3><p>通过如下代码我们可以使用Flutter内置的<a href="https://design.google.com/icons/" target="_blank" rel="noopener">material_fonts</a>：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">class MyApp extends StatelessWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    &#x2F;&#x2F; TODO: implement build</span><br><span class="line">    return new Scaffold(</span><br><span class="line">      appBar: new AppBar(</span><br><span class="line">        title: new Text(&quot;Icons&quot;),</span><br><span class="line">      ),</span><br><span class="line">      body: new Center(</span><br><span class="line">        child: new Icon(Icons.android,size: 100.0),</span><br><span class="line">      ),</span><br><span class="line">        );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="使用自定义的Icon"><a href="#使用自定义的Icon" class="headerlink" title="使用自定义的Icon"></a>使用自定义的Icon</h3><p>使用自定义的我们需要构造一个：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const IconData(</span><br><span class="line">  this.codePoint,&#x2F;&#x2F;必填参数，fonticon对应的16进制Unicode &#123;</span><br><span class="line">  this.fontFamily,&#x2F;&#x2F;字体库系列</span><br><span class="line">  this.fontPackage,&#x2F;&#x2F;字体在那个包中，不填仅在自己程序包中查找</span><br><span class="line">  this.matchTextDirection: false,图标是否按照图标绘制方向显示</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<p>首先我我们需要向使用字体一样，在pubspec.yaml中配置我们的icon：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fonts:</span><br><span class="line">	- family: devio</span><br><span class="line">	  fonts:</span><br><span class="line">	    - asset: fonts&#x2F;devio.ttf</span><br></pre></td></tr></table></figure></div>

<p>接下来就可以使用了：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">child: new Icon(new IconData(0xf5566,fontFamily: &quot;devio&quot;),size: 100.0,color: Colors.blueAccent,)</span><br></pre></td></tr></table></figure></div>





<h2 id="点击事件"><a href="#点击事件" class="headerlink" title="点击事件"></a>点击事件</h2><ul>
<li>1、widget本身带有点击事件响应属性。例如RaiseButton的onPressed</li>
<li>2、widget本身不支持点击响应，可用GestureDetector包裹，重写onTap()，还可以监听多种手势。</li>
</ul>
<h2 id="自定义字体使用以及MaterialApp主题themeData设置"><a href="#自定义字体使用以及MaterialApp主题themeData设置" class="headerlink" title="自定义字体使用以及MaterialApp主题themeData设置"></a>自定义字体使用以及MaterialApp主题themeData设置</h2><h1 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h1><p>精心设计的动画会让用户界面感觉更直观、流畅，能改善用户体验。 Flutter的动画支持可以轻松实现各种动画类型。许多widget，特别是<a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">Material Design widgets</a>， 都带有在其设计规范中定义的标准动画效果，但也可以自定义这些效果，在开始学习之前呢，我们先来快速过一下本篇文章的目录：</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li>在Flutter中有哪些类型的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">动画</a>？</li>
<li>如何使用动画库中的基础类给widget<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">添加动画</a>？</li>
<li>如何为动画<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">添加监听器</a>？</li>
<li>该什么时候使用<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimatedWidget</a>与<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimatedBuilder</a>?</li>
</ul>
<h2 id="在Flutter中有哪些类型的动画？"><a href="#在Flutter中有哪些类型的动画？" class="headerlink" title="在Flutter中有哪些类型的动画？"></a>在Flutter中有哪些类型的动画？</h2><p>在Flutter中动画分为两类：基于<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">tween</a>或<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">基于物理</a>的。</p>
<blockquote>
<p>推荐大家查阅我们上面课程中所讲到的Flutter gallery中的示例代码来学习动画。</p>
</blockquote>
<ul>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">补间(Tween)动画</a>：在补间动画中，定义了开始点和结束点、时间线以及定义转换时间和速度的曲线。然后由框架计算如何从开始点过渡到结束点。</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">基于物理的动画</a>：在基于物理的动画中，运动被模拟为与真实世界的行为相似。例如，当你掷球时，它在何处落地，取决于抛球速度有多快、球有多重、距离地面有多远。 类似地，将连接在弹簧上的球落下（并弹起）与连接到绳子上的球放下的方式也是不同。</li>
</ul>
<h2 id="如何使用动画库中的基础类给widget添加动画？"><a href="#如何使用动画库中的基础类给widget添加动画？" class="headerlink" title="如何使用动画库中的基础类给widget添加动画？"></a>如何使用动画库中的基础类给widget添加动画？</h2><p>在为widget添加动画之前，先让我们认识下动画的几个朋友：</p>
<ul>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>：是Flutter动画库中的一个核心类，它生成指导动画的值；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">CurvedAnimation</a>：Animation的一个子类，将过程抽象为一个非线性曲线；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimationController</a>：Animation的一个子类，用来管理Animation；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>：在正在执行动画的对象所使用的数据范围之间生成值。例如，Tween可生成从红到蓝之间的色值，或者从0到255；</li>
</ul>
<h3 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h3><p>在Flutter中，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象本身和UI渲染没有任何关系。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>是一个抽象类，它拥有其当前值和状态（完成或停止）。其中一个比较常用的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>类是<a href>Animation</a>。</p>
<p><strong>Flutter中的Animation对象是一个在一段时间内依次生成一个区间之间值的类</strong>。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象的输出可以是线性的、曲线的、一个步进函数或者任何其他可以设计的映射。 根据<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象的控制方式，动画可以反向运行，甚至可以在中间切换方向。</p>
<ul>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>还可以生成除double之外的其他类型值，如：<a href>Animation</a> 或 <a href>Animation</a>；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象有状态。可以通过访问其value属性获取动画的当前值；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象本身和UI渲染没有任何关系；</li>
</ul>
<h3 id="CurvedAnimation"><a href="#CurvedAnimation" class="headerlink" title="CurvedAnimation"></a>CurvedAnimation</h3><p><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">CurvedAnimation</a>将动画过程定义为一个非线性曲线。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final CurvedAnimation curve &#x3D;</span><br><span class="line">    new CurvedAnimation(parent: controller, curve: Curves.easeIn);</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>注: <a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Curves</a> 类定义了许多常用的曲线，也可以创建自己的，例如：</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class ShakeCurve extends Curve &#123;</span><br><span class="line">  @override</span><br><span class="line">  double transform(double t) &#123;</span><br><span class="line">    return math.sin(t * math.PI * 2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="AnimationController"><a href="#AnimationController" class="headerlink" title="AnimationController"></a>AnimationController</h3><p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener"><code>AnimationController</code></a>是一个特殊的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>Animation</code></a>对象，在屏幕刷新的每一帧，就会生成一个新的值。默认情况下，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimationController</code></a>在给定的时间段内会线性的生成从0.0到1.0的数字。 例如，下面代码创建一个Animation对象：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final AnimationController controller &#x3D; new AnimationController(</span><br><span class="line">    duration: const Duration(milliseconds: 2000), vsync: this);</span><br></pre></td></tr></table></figure></div>

<p>AnimationController派生自<code>Animation</code>，因此可以在需要Animation对象的任何地方使用。 但是，<code>AnimationController</code>具有控制动画的其他方法：</p>
<ul>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>forward()</code></a>：启动动画；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>reverse({double from})</code></a>：倒放动画；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>reset()</code></a>：重置动画，将其设置到动画的开始位置；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>stop({ bool canceled = true })</code></a>：停止动画；</li>
</ul>
<p>当创建一个<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimationController</a>时，需要传递一个vsync参数，存在vsync时会防止屏幕外动画消耗不必要的资源，可以将<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">stateful</a>对象作为vsync的值。</p>
<blockquote>
<p>注意： 在某些情况下，值(position，值动画的当前值)可能会超出<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimationController</a>的0.0-1.0的范围。例如，fling()函数允许您提供速度(velocity)、力量(force)、position(通过Force对象)。位置(position)可以是任何东西，因此可以在0.0到1.0范围之外。 <a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">CurvedAnimation</a>生成的值也可以超出0.0到1.0的范围。根据选择的曲线，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">CurvedAnimation</a>的输出可以具有比输入更大的范围。例如，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Curves.elasticIn</a>等弹性曲线会生成大于或小于默认范围的值。</p>
</blockquote>
<h3 id="Tween"><a href="#Tween" class="headerlink" title="Tween"></a>Tween</h3><p>默认情况下，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimationController</a>对象的范围从0.0到1.0。如果您需要不同的范围或不同的数据类型，则可以使用<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>来配置动画以生成不同的范围或数据类型的值。例如，以下示例，Tween生成从-200.0到0.0的值：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final Tween doubleTween &#x3D; new Tween&lt;double&gt;(begin: -200.0, end: 0.0);</span><br></pre></td></tr></table></figure></div>

<p><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>是一个无状态(stateless)对象，需要begin和end值。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>的唯一职责就是定义从输入范围到输出范围的映射。输入范围通常为0.0到1.0，但这不是必须的。</p>
<p>Tween继承自<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>Animatable</code></a>，而不是继承自<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>Animation</code></a>。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animatable</a>与<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>相似，不是必须输出double值。例如，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">ColorTween</a>指定两种颜色之间的过渡。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final Tween colorTween &#x3D;</span><br><span class="line">    new ColorTween(begin: Colors.transparent, end: Colors.black54);</span><br></pre></td></tr></table></figure></div>

<p>Tween对象不存储任何状态。相反，它提供了<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>evaluate(Animation animation)</code></a>方法将映射函数应用于动画当前值。 <a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>对象的当前值可以通过<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>value()</code></a>方法取到。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">evaluate</a>函数还执行一些其它处理，例如分别确保在动画值为0.0和1.0时返回开始和结束状态。</p>
<h4 id="Tween-animate"><a href="#Tween-animate" class="headerlink" title="Tween.animate"></a>Tween.animate</h4><p>要使用<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>对象，可调用它的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>animate()</code></a>方法，传入一个控制器对象。例如，以下代码在500毫秒内生成从0到255的整数值。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">final AnimationController controller &#x3D; new AnimationController(</span><br><span class="line">    duration: const Duration(milliseconds: 500), vsync: this);</span><br><span class="line">Animation&lt;int&gt; alpha &#x3D; new IntTween(begin: 0, end: 255).animate(controller);</span><br></pre></td></tr></table></figure></div>

<p>注意<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>animate()</code></a>返回的是一个<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>，而不是一个<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animatable</a>。</p>
<p>以下示例构建了一个控制器、一条曲线和一个<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Tween</a>：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">final AnimationController controller &#x3D; new AnimationController(</span><br><span class="line">    duration: const Duration(milliseconds: 500), vsync: this);</span><br><span class="line">final Animation curve &#x3D;</span><br><span class="line">    new CurvedAnimation(parent: controller, curve: Curves.easeOut);</span><br><span class="line">Animation&lt;int&gt; alpha &#x3D; new IntTween(begin: 0, end: 255).animate(curve);</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="为widget添加动画"><a href="#为widget添加动画" class="headerlink" title="为widget添加动画"></a>为widget添加动画</h3><p>在下面的实例中我们为一个logo添加了一个从小放大的动画：<a href="https://www.devio.org/io/flutter_app/img/blog/zoom.gif" target="_blank" rel="noopener" data-fancybox="group" data-caption="zoom.gif" class="fancybox"><img alt="zoom.gif" data-src="https://www.devio.org/io/flutter_app/img/blog/zoom.gif" class="lazyload" title="zoom.gif"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">class _LogoAppState extends State&lt;LogoApp&gt; with SingleTickerProviderStateMixin &#123;</span><br><span class="line">  Animation&lt;double&gt; animation;</span><br><span class="line">  AnimationController controller;</span><br><span class="line">  AnimationStatus animationState;</span><br><span class="line">  double animationValue;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void initState() &#123;</span><br><span class="line">    super.initState();</span><br><span class="line">    controller &#x3D;</span><br><span class="line">        AnimationController(duration: const Duration(seconds: 2), vsync: this);</span><br><span class="line">    &#x2F;&#x2F; #docregion addListener</span><br><span class="line">    animation &#x3D; Tween&lt;double&gt;(begin: 0, end: 300).animate(controller)</span><br><span class="line">      ..addListener(() &#123;</span><br><span class="line">        &#x2F;&#x2F; #enddocregion addListener</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          animationValue &#x3D; animation.value;</span><br><span class="line">        &#125;);</span><br><span class="line">        &#x2F;&#x2F; #docregion addListener</span><br><span class="line">      &#125;)</span><br><span class="line">      ..addStatusListener((AnimationStatus state) &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          animationState &#x3D; state;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#x2F;&#x2F; #enddocregion addListener</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Container(</span><br><span class="line">      margin: EdgeInsets.only(top: 50),</span><br><span class="line">      child: Column(</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          GestureDetector(</span><br><span class="line">            onTap: () &#123;</span><br><span class="line">              controller.reset();</span><br><span class="line">              controller.forward();</span><br><span class="line">            &#125;,</span><br><span class="line">            child: Text(&#39;Start&#39;, textDirection: TextDirection.ltr),</span><br><span class="line">          ),</span><br><span class="line">          Text(&#39;State:&#39; + animationState.toString(),</span><br><span class="line">              textDirection: TextDirection.ltr),</span><br><span class="line">          Text(&#39;Value:&#39; + animationValue.toString(),</span><br><span class="line">              textDirection: TextDirection.ltr),</span><br><span class="line">          Container(</span><br><span class="line">            height: animation.value,</span><br><span class="line">            width: animation.value,</span><br><span class="line">            child: FlutterLogo(),</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void dispose() &#123;</span><br><span class="line">    controller.dispose();</span><br><span class="line">    super.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<blockquote>
<p>注意，在上述代码中要实现这个动画的关键一步是在<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addListener()</code></a>的回调中添加<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>setState</code></a>的调用这样才能触发页面重新渲染，动画才能有效，另外也可以通过<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/#AnimatedWidget" target="_blank" rel="noopener">AnimatedWidget</a>来实现，在下文中会讲到。</p>
</blockquote>
<h2 id="如何为动画添加监听器？"><a href="#如何为动画添加监听器？" class="headerlink" title="如何为动画添加监听器？"></a>如何为动画添加监听器？</h2><p>有时我们需要知道动画执行的进度和状态，在Flutter中我们可以通过Animation的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addListener</code></a>与<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addStatusListener</code></a>方法为动画添加监听器：</p>
<ul>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addListener</code></a>：动画的值发生变化时被调用；</li>
<li><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addStatusListener</code></a>：动画状态发生变化时被调用；</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@override</span><br><span class="line"> void initState() &#123;</span><br><span class="line">   super.initState();</span><br><span class="line">   controller &#x3D;</span><br><span class="line">       AnimationController(duration: const Duration(seconds: 2), vsync: this);</span><br><span class="line">   animation &#x3D; Tween&lt;double&gt;(begin: 0, end: 300).animate(controller)</span><br><span class="line">     &#x2F;&#x2F; #enddocregion print-state</span><br><span class="line">     ..addStatusListener((status) &#123;</span><br><span class="line">       if (status &#x3D;&#x3D; AnimationStatus.completed) &#123;</span><br><span class="line">         controller.reverse();</span><br><span class="line">       &#125; else if (status &#x3D;&#x3D; AnimationStatus.dismissed) &#123;</span><br><span class="line">         controller.forward();</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">     &#x2F;&#x2F; #docregion print-state</span><br><span class="line">     ..addStatusListener((state) &#x3D;&gt; print(&#39;$state&#39;));</span><br><span class="line">     ..addListener(() &#123;</span><br><span class="line">       &#x2F;&#x2F; #enddocregion addListener</span><br><span class="line">       setState(() &#123;</span><br><span class="line">         &#x2F;&#x2F; The state that has changed here is the animation object’s value.</span><br><span class="line">       &#125;);</span><br><span class="line">       &#x2F;&#x2F; #docregion addListener</span><br><span class="line">     &#125;);</span><br><span class="line">   controller.forward();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>可对照学习<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">为widget添加动画</a>的例子；</p>
</blockquote>
<h2 id="用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用"><a href="#用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用" class="headerlink" title="用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用"></a>用AnimatedWidget与AnimatedBuilder简化和重构我们对动画的使用</h2><h3 id="什么是AnimatedWidget？"><a href="#什么是AnimatedWidget？" class="headerlink" title="什么是AnimatedWidget？"></a><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">什么是AnimatedWidget？</a></h3><p>我们可以将<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedWidget</code></a>理解为<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">Animation</a>的助手，使用它可以简化我们对动画的使用，在<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/#为widget添加动画" target="_blank" rel="noopener">为widget添加动画</a>的学习中我们不难发现，在不使用<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedWidget</code></a>的情况下需要手动调用动画的<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addListener()</code></a>并在回调中添加<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>setState</code></a>才能看到动画效果，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedWidget</code></a>将为我们简化这一操作。</p>
<p>在下面的重构示例中，LogoApp现在继承自<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedWidget</code></a>而不是<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>StatefulWidget</code></a>。<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedWidget</code></a>在绘制时使用动画的当前值。LogoApp仍然管理着<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimationController</code></a>和<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>Tween</code></a>。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">class AnimatedLogo extends AnimatedWidget &#123;</span><br><span class="line">  AnimatedLogo(&#123;Key key, Animation&lt;double&gt; animation&#125;)</span><br><span class="line">      : super(key: key, listenable: animation);</span><br><span class="line"></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    final Animation&lt;double&gt; animation &#x3D; listenable;</span><br><span class="line">    return new Center(</span><br><span class="line">      child: new Container(</span><br><span class="line">        margin: new EdgeInsets.symmetric(vertical: 10.0),</span><br><span class="line">        height: animation.value,</span><br><span class="line">        width: animation.value,</span><br><span class="line">        child: new FlutterLogo(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LogoApp extends StatefulWidget &#123;</span><br><span class="line">  _LogoAppState createState() &#x3D;&gt; new _LogoAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class _LogoAppState extends State&lt;LogoApp&gt; with SingleTickerProviderStateMixin &#123;</span><br><span class="line">  AnimationController controller;</span><br><span class="line">  Animation&lt;double&gt; animation;</span><br><span class="line"></span><br><span class="line">  initState() &#123;</span><br><span class="line">    super.initState();</span><br><span class="line">    controller &#x3D; new AnimationController(</span><br><span class="line">        duration: const Duration(milliseconds: 2000), vsync: this);</span><br><span class="line">    animation &#x3D; new Tween(begin: 0.0, end: 300.0).animate(controller);</span><br><span class="line">    controller.forward();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return new AnimatedLogo(animation: animation);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  dispose() &#123;</span><br><span class="line">    controller.dispose();</span><br><span class="line">    super.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="什么是AnimatedBuilder？"><a href="#什么是AnimatedBuilder？" class="headerlink" title="什么是AnimatedBuilder？"></a>什么是AnimatedBuilder？</h3><p><a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedBuilder</code></a>是用于构建动画的通用widget，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimatedBuilder</a>对于希望将动画作为更大构建函数的一部分包含在内的更复杂的widget时非常有用，其实你可以这样理解：<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener">AnimatedBuilder</a>是拆分动画的一个工具类，借助它我们可以将动画和widget进行分离：</p>
<p>在上面的实例中我们的代码存在的一个问题： 更改动画需要更改显示logo的widget。更好的解决方案是将职责分离：</p>
<ul>
<li>显示logo</li>
<li>定义Animation对象</li>
<li>渲染过渡效果</li>
</ul>
<p>接下来我们就借助<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedBuilder]()</code>类来完成此分离。<a href><code>AnimatedBuilder</code></a>是渲染树中的一个独立的类， 与<code>[AnimatedWidget</code></a>类似，<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>AnimatedBuilder</code></a>自动监听来自Animation对象的通知，不需要手动调用<a href="https://www.devio.org/2019/04/20/flutter-animation-tutorial-base/" target="_blank" rel="noopener"><code>addListener()</code></a>。</p>
<p>我们根据下图的 widget 树来创建我们的代码：</p>
<p><a href="https://www.devio.org/io/flutter_app/img/blog/AnimatedBuilder-WidgetTree.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="AnimatedBuilder-WidgetTree" class="fancybox"><img alt="AnimatedBuilder-WidgetTree" data-src="https://www.devio.org/io/flutter_app/img/blog/AnimatedBuilder-WidgetTree.png" class="lazyload" title="AnimatedBuilder-WidgetTree"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&#x2F;&#x2F; #docregion LogoWidget</span><br><span class="line">class LogoWidget extends StatelessWidget &#123;</span><br><span class="line">  &#x2F;&#x2F; Leave out the height and width so it fills the animating parent</span><br><span class="line">  Widget build(BuildContext context) &#x3D;&gt; Container(</span><br><span class="line">        margin: EdgeInsets.symmetric(vertical: 10),</span><br><span class="line">        child: FlutterLogo(),</span><br><span class="line">      );</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; #enddocregion LogoWidget</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; #docregion GrowTransition</span><br><span class="line">class GrowTransition extends StatelessWidget &#123;</span><br><span class="line">  GrowTransition(&#123;this.child, this.animation&#125;);</span><br><span class="line"></span><br><span class="line">  final Widget child;</span><br><span class="line">  final Animation&lt;double&gt; animation;</span><br><span class="line"></span><br><span class="line">  Widget build(BuildContext context) &#x3D;&gt; Center(</span><br><span class="line">        child: AnimatedBuilder(</span><br><span class="line">            animation: animation,</span><br><span class="line">            builder: (context, child) &#x3D;&gt; Container(</span><br><span class="line">                  height: animation.value,</span><br><span class="line">                  width: animation.value,</span><br><span class="line">                  child: child,</span><br><span class="line">                ),</span><br><span class="line">            child: child),</span><br><span class="line">      );</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; #enddocregion GrowTransition</span><br><span class="line"></span><br><span class="line">class LogoApp extends StatefulWidget &#123;</span><br><span class="line">  _LogoAppState createState() &#x3D;&gt; _LogoAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; #docregion print-state</span><br><span class="line">class _LogoAppState extends State&lt;LogoApp&gt; with SingleTickerProviderStateMixin &#123;</span><br><span class="line">  Animation&lt;double&gt; animation;</span><br><span class="line">  AnimationController controller;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void initState() &#123;</span><br><span class="line">    super.initState();</span><br><span class="line">    controller &#x3D;</span><br><span class="line">        AnimationController(duration: const Duration(seconds: 2), vsync: this);</span><br><span class="line">    animation &#x3D; Tween&lt;double&gt;(begin: 0, end: 300).animate(controller);</span><br><span class="line">    controller.forward();</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; #enddocregion print-state</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#x3D;&gt; GrowTransition(</span><br><span class="line">        child: LogoWidget(),</span><br><span class="line">        animation: animation,</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void dispose() &#123;</span><br><span class="line">    controller.dispose();</span><br><span class="line">    super.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; #docregion print-state</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><a href="https://coding.imooc.com/class/321.html" target="_blank" rel="noopener">点我查看全部完整代码</a>。</p>
</blockquote>
<h3 id="示例项目学习"><a href="#示例项目学习" class="headerlink" title="示例项目学习"></a>示例项目学习</h3><p>flutter官方  sdk里有现成的</p>
<h2 id="1-导航栏"><a href="#1-导航栏" class="headerlink" title="1.导航栏"></a>1.导航栏</h2><p>setState（fn）只有StatefulWidget才有！！！</p>
<h2 id="PageView-页面组"><a href="#PageView-页面组" class="headerlink" title="PageView 页面组"></a>PageView 页面组</h2><p>滑动切换显示页面<br><code>PageController _controller = PageController();   //为PageView设置控制器，主要用于翻页</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PageView(</span><br><span class="line">    controller: _controller,  &#x2F;&#x2F;控制跳转到哪一页， _controller.jumpToPage(index);</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">              HomePage(),</span><br><span class="line">              SearchPage(),</span><br><span class="line">              TripPage(),</span><br><span class="line">              MyPage(),</span><br><span class="line">                ...</span><br><span class="line">              ],</span><br><span class="line">),</span><br></pre></td></tr></table></figure></div>
<p><code>_controller.jumpToPage(index);   //控制跳转到哪一页</code></p>
<h3 id="BottomNavigationBar-底部导航栏"><a href="#BottomNavigationBar-底部导航栏" class="headerlink" title="BottomNavigationBar 底部导航栏"></a>BottomNavigationBar 底部导航栏</h3><p><code>int _currentIndex = 0 ;</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">BottomNavigationBar(</span><br><span class="line">          &#x2F;**</span><br><span class="line">           * 导航栏点击事件响应</span><br><span class="line">           *&#x2F;</span><br><span class="line">          onTap: (index)&#123;</span><br><span class="line">            _controller.jumpToPage(index);  &#x2F;&#x2F;跳转页面</span><br><span class="line">           setState(()&#123; &#x2F;&#x2F;更新widget中的状态</span><br><span class="line">           _currentIndex&#x3D;index;</span><br><span class="line">           &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          currentIndex: _currentIndex, &#x2F;&#x2F;指定当前active项,才会启用activeIcon</span><br><span class="line"></span><br><span class="line">          type: BottomNavigationBarType.fixed, &#x2F;&#x2F;title不隐藏 ,若要隐藏设为shifting</span><br><span class="line">          &#x2F;**</span><br><span class="line">           * 导航栏item</span><br><span class="line">           *&#x2F;</span><br><span class="line">          items: [</span><br><span class="line">            BottomNavigationBarItem(</span><br><span class="line">              icon: Icon(Icons.home,color: Colors.grey,),</span><br><span class="line">              activeIcon:  Icon(Icons.home,color: Colors.blue,),</span><br><span class="line">              title: Text(&#39;首页&#39;,style: TextStyle(color: _currentIndex&#x3D;&#x3D;0?Colors.blue:Colors.grey),),</span><br><span class="line">            ),</span><br><span class="line">            ...</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      )</span><br></pre></td></tr></table></figure></div>
<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import &#39;package:flutter&#x2F;material.dart&#39;;</span><br><span class="line">import &#39;package:my_trip_app&#x2F;pages&#x2F;home_page.dart&#39;;</span><br><span class="line">import &#39;package:my_trip_app&#x2F;pages&#x2F;my_page.dart&#39;;</span><br><span class="line">import &#39;package:my_trip_app&#x2F;pages&#x2F;search_page.dart&#39;;</span><br><span class="line">import &#39;package:my_trip_app&#x2F;pages&#x2F;trip_page.dart&#39;;</span><br><span class="line"></span><br><span class="line">void main() &#x3D;&gt; runApp(MyApp());</span><br><span class="line"></span><br><span class="line">class MyApp extends StatefulWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  _MyAppState createState() &#x3D;&gt; _MyAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class _MyAppState extends State&lt;MyApp&gt; &#123;</span><br><span class="line"></span><br><span class="line">  PageController _controller &#x3D; PageController();</span><br><span class="line">  int _currentIndex &#x3D; 0 ;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">     return MaterialApp(</span><br><span class="line">      title: &#39;Flutter Trip App&#39;,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        body: Center(</span><br><span class="line">          child: PageView(</span><br><span class="line">            controller: _controller,</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              HomePage(),</span><br><span class="line">              SearchPage(),</span><br><span class="line">              TripPage(),</span><br><span class="line">              MyPage()</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line"></span><br><span class="line">        bottomNavigationBar: BottomNavigationBar(</span><br><span class="line">          &#x2F;**</span><br><span class="line">           * 导航栏点击事件响应</span><br><span class="line">           *&#x2F;</span><br><span class="line">          onTap: (index)&#123;</span><br><span class="line">            _controller.jumpToPage(index);</span><br><span class="line">           setState(()&#123; &#x2F;&#x2F;更新widget中的状态</span><br><span class="line">           _currentIndex&#x3D;index;</span><br><span class="line">           &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          currentIndex: _currentIndex, &#x2F;&#x2F;指定当前active项</span><br><span class="line">          type: BottomNavigationBarType.fixed, &#x2F;&#x2F;title不隐藏 ,若要隐藏设为shifting</span><br><span class="line">          &#x2F;**</span><br><span class="line">           * 导航栏item</span><br><span class="line">           *&#x2F;</span><br><span class="line">          items: [</span><br><span class="line">            BottomNavigationBarItem(</span><br><span class="line">              icon: Icon(Icons.home,color: Colors.grey,),</span><br><span class="line">              activeIcon:  Icon(Icons.home,color: Colors.blue,),</span><br><span class="line">              title: Text(&#39;首页&#39;,style: TextStyle(color: _currentIndex&#x3D;&#x3D;0?Colors.blue:Colors.grey),),</span><br><span class="line">            ),</span><br><span class="line">             BottomNavigationBarItem(</span><br><span class="line">              icon: Icon(Icons.search,color: Colors.grey,),</span><br><span class="line">              activeIcon:  Icon(Icons.search,color: Colors.blue,),</span><br><span class="line">              title: Text(&#39;搜索&#39;,style: TextStyle(color: _currentIndex&#x3D;&#x3D;1?Colors.blue:Colors.grey),),</span><br><span class="line">            ),</span><br><span class="line">             BottomNavigationBarItem(</span><br><span class="line">              icon: Icon(Icons.photo_camera,color: Colors.grey,),</span><br><span class="line">              activeIcon:  Icon(Icons.photo_camera,color: Colors.blue,),</span><br><span class="line">              title: Text(&#39;旅拍&#39;,style: TextStyle(color: _currentIndex&#x3D;&#x3D;2?Colors.blue:Colors.grey),),</span><br><span class="line">            ),</span><br><span class="line">             BottomNavigationBarItem(</span><br><span class="line">              icon: Icon(Icons.person,color: Colors.grey,),</span><br><span class="line">              activeIcon:  Icon(Icons.person,color: Colors.blue,),</span><br><span class="line">              title: Text(&#39;我的&#39;,style: TextStyle(color: _currentIndex&#x3D;&#x3D;3?Colors.blue:Colors.grey),),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="2-搜索栏"><a href="#2-搜索栏" class="headerlink" title="2.搜索栏"></a>2.搜索栏</h2><p>略</p>
<h1 id="轮播Banner"><a href="#轮播Banner" class="headerlink" title="轮播Banner"></a>轮播Banner</h1><p>flutter_swiper插件<br><a href="https://github.com/best-flutter/flutter_swiper/blob/master/README-ZH.md" target="_blank" rel="noopener">https://github.com/best-flutter/flutter_swiper/blob/master/README-ZH.md</a></p>
<p>#appBar颜色随滚动渐变透明<br>NotificationListener包裹ListView，实现notification即可。<br>不同状态下触发不同的notification，注意runtimeType和depth<br>需要透明度时需使用Opacity组件包裹并设置opacity属性。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NotificationListener(</span><br><span class="line">          onNotification: (scrollNotification)&#123;</span><br><span class="line">            if(scrollNotification.runtimeType&#x3D;&#x3D;ScrollUpdateNotification&amp;&amp;scrollNotification.depth&#x3D;&#x3D;0)&#123;</span><br><span class="line">              print(scrollNotification.metrics.pixels);&#x2F;&#x2F;相对于顶部,移动的距离，单位pixels</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">      child: ListView(</span><br><span class="line">        padding: EdgeInsets.only(top: 0),  &#x2F;&#x2F;ListView顶部默认会留空</span><br><span class="line">        children: &lt;Widget&gt;[</span><br></pre></td></tr></table></figure></div>

<h1 id="entity和dao层"><a href="#entity和dao层" class="headerlink" title="entity和dao层"></a>entity和dao层</h1><p>略<br>数据和wdiget骨架分离<br>item=&gt;items=&gt;传参构造</p>
<p>#布局思路：<br>先划分好空间，再布局子项（1：Stack+Align  2: Container + Alignment）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Row&#x2F;Colum</span><br><span class="line">     &#x3D;&gt; Expand弹性分配空间</span><br><span class="line">             &#x3D;&gt; FractionallySizedBox控件弹性填充</span><br><span class="line">                      &#x3D;&gt; Container       </span><br><span class="line">                              &#x3D;&gt;控件(Alignment&#x2F;AlignmentDirectional)         ||     &#x3D;&gt; Stack    </span><br><span class="line">                                                                             ||          &#x3D;&gt; Align(FractionalOffset定位)</span><br></pre></td></tr></table></figure></div>
<p>FractionallySizedBox负责将其child沿宽或高方向拉伸</p>
<p>PhysicalModel  相当于可以快速设置容器形状的Container</p>
<p>#启动时进度条等待<br>数据获取完毕前只显示进度条，完毕后再传入需要显示的widget。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import &#39;package:flutter&#x2F;material.dart&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;&#x2F;加载进度条组件</span><br><span class="line">class LoadingContainer extends StatelessWidget &#123;</span><br><span class="line">  final Widget child;  &#x2F;&#x2F;加载完成后显示的widget</span><br><span class="line">  final bool isLoading;</span><br><span class="line">  final bool cover;  &#x2F;&#x2F;是否浮动于当前页面之上</span><br><span class="line"></span><br><span class="line">  const LoadingContainer(</span><br><span class="line">      &#123;Key key,</span><br><span class="line">      @required this.isLoading,</span><br><span class="line">      this.cover &#x3D; false,  &#x2F;&#x2F;默认不浮动之上</span><br><span class="line">      @required this.child&#125;)</span><br><span class="line">      : super(key: key);</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return !cover</span><br><span class="line">        ? !isLoading ? child : _loadingView</span><br><span class="line">        : Stack(</span><br><span class="line">            children: &lt;Widget&gt;[child, isLoading ? _loadingView : Container()],</span><br><span class="line">          );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget get _loadingView &#123;</span><br><span class="line">    return Center(</span><br><span class="line">      child: CircularProgressIndicator(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="下拉刷新-RefreshIndicator"><a href="#下拉刷新-RefreshIndicator" class="headerlink" title="下拉刷新  RefreshIndicator"></a>下拉刷新  RefreshIndicator</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RefreshIndicator(</span><br><span class="line">          onRefresh: _handleRefresh,  &#x2F;&#x2F;下拉回调函数</span><br><span class="line">          child:  NotificationListener(</span><br><span class="line">      ...</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 如果 p 为 non-null，设置它变量 y 的值为 4。</span><br><span class="line">p?.y &#x3D; 4;</span><br></pre></td></tr></table></figure></div>

<h1 id="包与插件"><a href="#包与插件" class="headerlink" title="包与插件"></a>包与插件</h1><p>包：尤指为flutter服务的dart包，只包含dart部分，不涉及Android或iOS原生代码</p>
<ul>
<li>可视化：选择flutter package</li>
<li>命令行：<code>flutter create  --template=package  包名</code></li>
</ul>
<p>插件：涉及Android或iOS原生开发</p>
<ul>
<li>可视化：选择flutter package</li>
<li>命令行：<code>flutter create --org  cn.coderhan  --template=plugin   插件名</code></li>
</ul>
<p>编写：代码、README.md说明文档、CHANGELOG.md版本变更记录与说明、LICENSE</p>
<p>发布：</p>
<ul>
<li><code>flutter  packages  pub publish --dry-run</code>   检查package是否准备好</li>
<li><code>flutter  packages  pub publish</code>   正式发布</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">HanJQ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://coderhan.cn/2020/01/23/mytrip/">http://coderhan.cn/2020/01/23/mytrip/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Flutter/">Flutter    </a><a class="post-meta__tags" href="/tags/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/">移动开发    </a></div><div class="post_share"><div class="social-share" data-image="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579787484877&amp;di=b435abf9485bb65adf52e3394c029401&amp;imgtype=0&amp;src=http%3A%2F%2Fhzadm.zhongchoujia.com%2FUploadFiles%2F2016-12-08%2F6361680627104931767309148.png" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/01/23/LearnFlutter/"><img class="next_cover lazyload" data-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579786805846&amp;di=258ba5091adab8ea3a233db31ae9c3d0&amp;imgtype=0&amp;src=http%3A%2F%2Fmat1.gtimg.com%2Fdigi%2F2012%2Fhanhanone%2Fone_r2_c1.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>高仿ONE•一个</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/01/23/LearnFlutter/" title="高仿ONE•一个"><img class="relatedPosts_cover lazyload"data-src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1579786805846&di=258ba5091adab8ea3a233db31ae9c3d0&imgtype=0&src=http%3A%2F%2Fmat1.gtimg.com%2Fdigi%2F2012%2Fhanhanone%2Fone_r2_c1.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-23</div><div class="relatedPosts_title">高仿ONE•一个</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By HanJQ</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>